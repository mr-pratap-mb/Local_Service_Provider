import{r as o,u as h,j as e,s as d}from"./index-B3IZbtJy.js";function p(){const[l,t]=o.useState([]),[m,r]=o.useState(!0),x=h();o.useEffect(()=>{let s=!0;async function c(){r(!0);const{data:i}=await d.auth.getUser(),n=i?.user?.id;if(!n){t([]),r(!1);return}const{data:a,error:u}=await d.from("bookings").select("*, service:service_id ( title ), provider:provider_id ( full_name )").eq("user_id",n).order("created_at",{ascending:!1});u?(console.error(u),t([])):s&&t(a||[]),r(!1)}return c(),()=>{s=!1}},[]);async function g(s){if(!window.confirm("Do you really want to cancel this booking?"))return;const{error:i}=await d.from("bookings").update({status:"cancelled"}).eq("id",s);i?alert("Cancel failed: "+i.message):t(n=>n.map(a=>a.id===s?{...a,status:"cancelled"}:a))}return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 to-purple-50 p-6",children:e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-800",children:"Your Bookings"}),m?e.jsx("div",{className:"p-4 bg-white rounded-lg shadow",children:"Loading bookings..."}):l.length===0?e.jsx("div",{className:"p-4 bg-white rounded-lg shadow text-gray-500",children:"You haven't made any bookings yet."}):e.jsx("div",{className:"space-y-4",children:l.map(s=>e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-lg",children:s.service?.title||"Service"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Provider: ",s.provider?.full_name||"â€”"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Scheduled: ",new Date(s.scheduled_date).toLocaleString()]}),e.jsxs("div",{className:"text-sm",children:["Status: ",e.jsx("span",{className:"font-medium",children:s.status})]})]}),e.jsxs("div",{className:"flex gap-2",children:[s.status==="pending"&&e.jsx("button",{onClick:()=>g(s.id),className:"px-3 py-1 rounded bg-red-500 text-white",children:"Cancel"}),e.jsx("button",{onClick:()=>x(`/services/${s.service_id}`),className:"px-3 py-1 rounded border",children:"View"})]})]},s.id))})]})})}export{p as default};
