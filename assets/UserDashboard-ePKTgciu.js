import{b as h,r as a,s as o,j as e}from"./index-2ZjFlii8.js";function g(){const{user:r,profile:i}=h(),[d,n]=a.useState([]),[x,l]=a.useState(!0);a.useEffect(()=>{r&&(c(),m())},[r]);const c=async()=>{try{l(!0);const{data:s,error:t}=await o.from("bookings").select("*, provider:provider_id(full_name, email), service:service_id(title)").eq("user_id",r.id).order("created_at",{ascending:!1});if(t)throw t;n(s||[])}catch(s){console.error("Error fetching dashboard data:",s)}finally{l(!1)}},m=()=>{const s=o.channel(`user_bookings:${r.id}`).on("postgres_changes",{event:"*",schema:"public",table:"bookings",filter:`user_id=eq.${r.id}`},t=>{console.log("Booking update received:",t),c()}).subscribe();return()=>s.unsubscribe()};return x?e.jsx("div",{className:"min-h-screen bg-gray-50 py-10 px-6 text-center",children:e.jsx("div",{className:"text-gray-600 text-lg",children:"Loading dashboard..."})}):!i||i.role!=="user"?e.jsx("div",{className:"min-h-screen bg-gray-50 py-10 px-6 text-center",children:e.jsx("div",{className:"text-red-600 text-lg",children:"Access denied. User role required."})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-10 px-4 sm:px-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold mb-6 text-gray-800",children:"Your Dashboard"}),e.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-lg shadow-md border border-gray-100",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-semibold mb-4 text-gray-700",children:"Your Bookings"}),d.length===0?e.jsx("div",{className:"text-gray-500 text-center py-6",children:"No bookings yet."}):e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:gap-6",children:d.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 flex flex-col sm:flex-row sm:justify-between sm:items-center bg-white hover:shadow-sm transition-shadow duration-200",children:[e.jsxs("div",{className:"mb-3 sm:mb-0 sm:flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900 text-base",children:s.service?.title||"Service"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Provider: ",s.provider?.full_name||s.provider?.email||"N/A"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Date: ",new Date(s.scheduled_date).toLocaleString()]})]}),e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${s.status==="accepted"?"bg-green-100 text-green-800":s.status==="cancelled"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})})]},s.id))}),e.jsx("button",{onClick:()=>window.location.href="/services",className:"mt-6 w-full sm:w-auto bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition",children:"Book a Service"})]})]})})}export{g as default};
