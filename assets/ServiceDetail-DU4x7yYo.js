import{g as te,r as W,j as f,s as z,a as re,u as ne}from"./index-B3IZbtJy.js";var q={exports:{}},se=q.exports,Q;function ie(){return Q||(Q=1,(function(N,D){(function(_,M){N.exports=M()})(se,(function(){var _=1e3,M=6e4,Y=36e5,S="millisecond",x="second",b="minute",p="hour",m="day",T="week",g="month",E="quarter",y="year",H="date",P="Invalid Date",G=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,K=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,X={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(s){var r=["th","st","nd","rd"],e=s%100;return"["+s+(r[(e-20)%10]||r[e]||r[0])+"]"}},J=function(s,r,e){var n=String(s);return!n||n.length>=r?s:""+Array(r+1-n.length).join(e)+s},ee={s:J,z:function(s){var r=-s.utcOffset(),e=Math.abs(r),n=Math.floor(e/60),t=e%60;return(r<=0?"+":"-")+J(n,2,"0")+":"+J(t,2,"0")},m:function s(r,e){if(r.date()<e.date())return-s(e,r);var n=12*(e.year()-r.year())+(e.month()-r.month()),t=r.clone().add(n,g),i=e-t<0,a=r.clone().add(n+(i?-1:1),g);return+(-(n+(e-t)/(i?t-a:a-t))||0)},a:function(s){return s<0?Math.ceil(s)||0:Math.floor(s)},p:function(s){return{M:g,y,w:T,d:m,D:H,h:p,m:b,s:x,ms:S,Q:E}[s]||String(s||"").toLowerCase().replace(/s$/,"")},u:function(s){return s===void 0}},C="en",j={};j[C]=X;var V="$isDayjsObject",Z=function(s){return s instanceof F||!(!s||!s[V])},A=function s(r,e,n){var t;if(!r)return C;if(typeof r=="string"){var i=r.toLowerCase();j[i]&&(t=i),e&&(j[i]=e,t=i);var a=r.split("-");if(!t&&a.length>1)return s(a[0])}else{var o=r.name;j[o]=r,t=o}return!n&&t&&(C=t),t||!n&&C},d=function(s,r){if(Z(s))return s.clone();var e=typeof r=="object"?r:{};return e.date=s,e.args=arguments,new F(e)},u=ee;u.l=A,u.i=Z,u.w=function(s,r){return d(s,{locale:r.$L,utc:r.$u,x:r.$x,$offset:r.$offset})};var F=(function(){function s(e){this.$L=A(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[V]=!0}var r=s.prototype;return r.parse=function(e){this.$d=(function(n){var t=n.date,i=n.utc;if(t===null)return new Date(NaN);if(u.u(t))return new Date;if(t instanceof Date)return new Date(t);if(typeof t=="string"&&!/Z$/i.test(t)){var a=t.match(G);if(a){var o=a[2]-1||0,c=(a[7]||"0").substring(0,3);return i?new Date(Date.UTC(a[1],o,a[3]||1,a[4]||0,a[5]||0,a[6]||0,c)):new Date(a[1],o,a[3]||1,a[4]||0,a[5]||0,a[6]||0,c)}}return new Date(t)})(e),this.init()},r.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},r.$utils=function(){return u},r.isValid=function(){return this.$d.toString()!==P},r.isSame=function(e,n){var t=d(e);return this.startOf(n)<=t&&t<=this.endOf(n)},r.isAfter=function(e,n){return d(e)<this.startOf(n)},r.isBefore=function(e,n){return this.endOf(n)<d(e)},r.$g=function(e,n,t){return u.u(e)?this[n]:this.set(t,e)},r.unix=function(){return Math.floor(this.valueOf()/1e3)},r.valueOf=function(){return this.$d.getTime()},r.startOf=function(e,n){var t=this,i=!!u.u(n)||n,a=u.p(e),o=function(O,$){var w=u.w(t.$u?Date.UTC(t.$y,$,O):new Date(t.$y,$,O),t);return i?w:w.endOf(m)},c=function(O,$){return u.w(t.toDate()[O].apply(t.toDate("s"),(i?[0,0,0,0]:[23,59,59,999]).slice($)),t)},l=this.$W,h=this.$M,v=this.$D,L="set"+(this.$u?"UTC":"");switch(a){case y:return i?o(1,0):o(31,11);case g:return i?o(1,h):o(0,h+1);case T:var k=this.$locale().weekStart||0,I=(l<k?l+7:l)-k;return o(i?v-I:v+(6-I),h);case m:case H:return c(L+"Hours",0);case p:return c(L+"Minutes",1);case b:return c(L+"Seconds",2);case x:return c(L+"Milliseconds",3);default:return this.clone()}},r.endOf=function(e){return this.startOf(e,!1)},r.$set=function(e,n){var t,i=u.p(e),a="set"+(this.$u?"UTC":""),o=(t={},t[m]=a+"Date",t[H]=a+"Date",t[g]=a+"Month",t[y]=a+"FullYear",t[p]=a+"Hours",t[b]=a+"Minutes",t[x]=a+"Seconds",t[S]=a+"Milliseconds",t)[i],c=i===m?this.$D+(n-this.$W):n;if(i===g||i===y){var l=this.clone().set(H,1);l.$d[o](c),l.init(),this.$d=l.set(H,Math.min(this.$D,l.daysInMonth())).$d}else o&&this.$d[o](c);return this.init(),this},r.set=function(e,n){return this.clone().$set(e,n)},r.get=function(e){return this[u.p(e)]()},r.add=function(e,n){var t,i=this;e=Number(e);var a=u.p(n),o=function(h){var v=d(i);return u.w(v.date(v.date()+Math.round(h*e)),i)};if(a===g)return this.set(g,this.$M+e);if(a===y)return this.set(y,this.$y+e);if(a===m)return o(1);if(a===T)return o(7);var c=(t={},t[b]=M,t[p]=Y,t[x]=_,t)[a]||1,l=this.$d.getTime()+e*c;return u.w(l,this)},r.subtract=function(e,n){return this.add(-1*e,n)},r.format=function(e){var n=this,t=this.$locale();if(!this.isValid())return t.invalidDate||P;var i=e||"YYYY-MM-DDTHH:mm:ssZ",a=u.z(this),o=this.$H,c=this.$m,l=this.$M,h=t.weekdays,v=t.months,L=t.meridiem,k=function($,w,B,U){return $&&($[w]||$(n,i))||B[w].slice(0,U)},I=function($){return u.s(o%12||12,$,"0")},O=L||function($,w,B){var U=$<12?"AM":"PM";return B?U.toLowerCase():U};return i.replace(K,(function($,w){return w||(function(B){switch(B){case"YY":return String(n.$y).slice(-2);case"YYYY":return u.s(n.$y,4,"0");case"M":return l+1;case"MM":return u.s(l+1,2,"0");case"MMM":return k(t.monthsShort,l,v,3);case"MMMM":return k(v,l);case"D":return n.$D;case"DD":return u.s(n.$D,2,"0");case"d":return String(n.$W);case"dd":return k(t.weekdaysMin,n.$W,h,2);case"ddd":return k(t.weekdaysShort,n.$W,h,3);case"dddd":return h[n.$W];case"H":return String(o);case"HH":return u.s(o,2,"0");case"h":return I(1);case"hh":return I(2);case"a":return O(o,c,!0);case"A":return O(o,c,!1);case"m":return String(c);case"mm":return u.s(c,2,"0");case"s":return String(n.$s);case"ss":return u.s(n.$s,2,"0");case"SSS":return u.s(n.$ms,3,"0");case"Z":return a}return null})($)||a.replace(":","")}))},r.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},r.diff=function(e,n,t){var i,a=this,o=u.p(n),c=d(e),l=(c.utcOffset()-this.utcOffset())*M,h=this-c,v=function(){return u.m(a,c)};switch(o){case y:i=v()/12;break;case g:i=v();break;case E:i=v()/3;break;case T:i=(h-l)/6048e5;break;case m:i=(h-l)/864e5;break;case p:i=h/Y;break;case b:i=h/M;break;case x:i=h/_;break;default:i=h}return t?i:u.a(i)},r.daysInMonth=function(){return this.endOf(g).$D},r.$locale=function(){return j[this.$L]},r.locale=function(e,n){if(!e)return this.$L;var t=this.clone(),i=A(e,n,!0);return i&&(t.$L=i),t},r.clone=function(){return u.w(this.$d,this)},r.toDate=function(){return new Date(this.valueOf())},r.toJSON=function(){return this.isValid()?this.toISOString():null},r.toISOString=function(){return this.$d.toISOString()},r.toString=function(){return this.$d.toUTCString()},s})(),R=F.prototype;return d.prototype=R,[["$ms",S],["$s",x],["$m",b],["$H",p],["$W",m],["$M",g],["$y",y],["$D",H]].forEach((function(s){R[s[1]]=function(r){return this.$g(r,s[0],s[1])}})),d.extend=function(s,r){return s.$i||(s(r,F,d),s.$i=!0),d},d.locale=A,d.isDayjs=Z,d.unix=function(s){return d(1e3*s)},d.en=j[C],d.Ls=j,d.p={},d}))})(q)),q.exports}var ae=ie();const ue=te(ae);function oe({serviceId:N,providerId:D,onBooked:_}){const[M,Y]=W.useState(""),[S,x]=W.useState(!1);async function b(p){p.preventDefault(),x(!0);try{const{data:m,error:T}=await z.auth.getUser();if(T||!m?.user)throw new Error("You must be logged in.");const g=m.user.id,{data:E,error:y}=await z.from("bookings").insert([{user_id:g,provider_id:D,service_id:N,scheduled_date:ue(M).toISOString()}]).select().single();if(y)throw y;alert("✅ Booking successful!"),_?.(E)}catch(m){alert("Booking failed: "+m.message),console.error(m)}finally{x(!1)}}return f.jsxs("form",{onSubmit:b,className:"space-y-4",children:[f.jsxs("label",{className:"block",children:[f.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Choose Date & Time"}),f.jsx("input",{type:"datetime-local",required:!0,value:M,onChange:p=>Y(p.target.value),className:"mt-1 block w-full rounded border-gray-300 p-2"})]}),f.jsx("button",{type:"submit",disabled:S,className:"w-full bg-purple-600 text-white py-2 rounded-md hover:bg-purple-700 transition",children:S?"Booking...":"Book Now"})]})}function de(){const{id:N}=re(),[D,_]=W.useState(null),[M,Y]=W.useState(!0),S=ne();return W.useEffect(()=>{async function x(){const{data:b,error:p}=await z.from("services").select("*, provider:provider_id ( id, full_name )").eq("id",N).single();p&&console.error(p),_(b),Y(!1)}x()},[N]),M?f.jsx("div",{className:"p-10 text-center text-purple-700",children:"Loading service..."}):D?f.jsx("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 to-purple-50 py-10 px-6",children:f.jsx("div",{className:"max-w-5xl mx-auto bg-white rounded-2xl shadow p-6",children:f.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("h1",{className:"text-2xl font-bold text-purple-700 mb-2",children:D.title}),f.jsx("p",{className:"text-gray-700 mb-2",children:D.description}),f.jsxs("p",{className:"text-indigo-600 font-semibold mb-1",children:["₹",D.price]}),f.jsxs("p",{className:"text-sm text-gray-500",children:["Provider: ",D.provider?.full_name||"—"]})]}),f.jsxs("div",{className:"w-full md:w-96 bg-gray-50 p-4 rounded-lg shadow-inner",children:[f.jsx("h3",{className:"text-lg font-semibold text-purple-700 mb-2",children:"Book this Service"}),f.jsx(oe,{serviceId:D.id,providerId:D.provider_id,onBooked:()=>{alert("Booking created!"),S("/user-dashboard")}})]})]})})}):f.jsx("div",{className:"p-10 text-center text-gray-600",children:"Service not found."})}export{de as default};
